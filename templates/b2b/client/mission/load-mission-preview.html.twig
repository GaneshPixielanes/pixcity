<style>
    #invoice{
        padding: 30px;
    }

    .invoice {
        position: relative;
        background-color: #FFF;
        min-height: 680px;
        padding: 15px
    }

    .invoice header {
        padding: 10px 0;
        margin-bottom: 20px;
        border-bottom: 1px solid #3989c6
    }

    .invoice .company-details {
        text-align: right
    }

    .invoice .company-details .name {
        margin-top: 0;
        margin-bottom: 0
    }

    .invoice .contacts {
        margin-bottom: 20px
    }

    .invoice .invoice-to {
        text-align: left
    }

    .invoice .invoice-to .to {
        margin-top: 0;
        margin-bottom: 0
    }

    .invoice .invoice-details {
        text-align: right
    }

    .invoice .invoice-details .invoice-id {
        margin-top: 0;
        color: #3989c6
    }

    .invoice main {
        padding-bottom: 50px
    }

    .invoice main .thanks {
        margin-top: -79px;
        font-size: 2em;
        margin-bottom: 50px
    }

    .invoice main .notices {
        padding-left: 6px;
        border-left: 6px solid #3989c6
    }

    .invoice main .notices .notice {
        font-size: 1.2em
    }

    .invoice table {
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
        margin-bottom: 20px
    }

    .invoice table td,.invoice table th {
        padding: 15px;
        background: #eee;
        border-bottom: 1px solid #fff
    }

    .invoice table th {
        white-space: nowrap;
        font-weight: 400;
        font-size: 16px
    }

    .invoice table td h3 {
        margin: 0;
        font-weight: 400;
        color: #3989c6;
        font-size: 1.2em
    }

    .invoice table .qty,.invoice table .total,.invoice table .unit {
        text-align: right;
        font-size: 1.2em
    }

    .invoice table .no {
        color: #fff;
        font-size: 1.6em;
        background: #3989c6
    }

    .invoice table .unit {
        background: #ddd
    }

    .invoice table .total {
        background: #3989c6;
        color: #fff
    }

    .invoice table tbody tr:last-child td {
        border: none
    }

    .invoice table tfoot td {
        background: 0 0;
        border-bottom: none;
        white-space: nowrap;
        text-align: right;
        padding: 10px 20px;
        font-size: 1.2em;
        border-top: 1px solid #aaa
    }

    .invoice table tfoot tr:first-child td {
        border-top: none
    }

    .invoice table tfoot tr:last-child td {
        color: #3989c6;
        font-size: 1.4em;
        border-top: 1px solid #3989c6
    }

    .invoice table tfoot tr td:first-child {
        border: none
    }

    .invoice footer {
        width: 100%;
        text-align: center;
        color: #777;
        border-top: 1px solid #aaa;
        padding: 8px 0
    }

    @media print {
        .invoice {
            font-size: 11px!important;
            overflow: hidden!important
        }

        .invoice footer {
            position: absolute;
            bottom: 10px;
            page-break-after: always
        }

        .invoice>div:last-child {
            page-break-before: always
        }
    }
</style>

 {% if route == 'b2b_client_mission_list'  or route == 'b2b_client_main_index' %}

     <div class="cover-image-container text-normalgray d-flex flex-column align-items-center justify-content-center position-relative">
        <img src="{{ mission.getBannerUrl() }}" class="cover-image w-100 h-100" alt="Mission Cover Image">
    </div>

    <div class="pack-details p-3">
        <div class="pack-overview-container col-sm-12 border-bottom mt-2 mb-4 pb-4">
            <p class="text-textgray fz-12 mb-0">{{ mission.referencePack.packskill.name }}</p>
            <h5 class="text-darkgray mb-3">{{ mission.title }} </h5>
            {{ mission.description }}
        </div>
        {% if mission.missionMedia | length > 0 %}
        <div class="pack-photos-container col-sm-12 border-bottom mt-2 mb-4 pb-4">
            <h5 class="text-darkgray mb-0">Photos</h5>
            <div class="pack-photos">
                <ul class="pack-photos-list d-flex flex-wrap p-0 m-0">
                    {% for media in mission.missionMedia %}
                        <li class="pack-photos-list-item d-inline-flex">
                            <img src="{{ media.url }}" alt="Pack photo 1">
                        </li>
                    {% endfor %}

                </ul>
            </div>
        </div>
        {% endif %}
    </div>

    <nav class="col-sm-12 navbar navbar-expand-lg fixed-bottom nav-bar-main internal-nav bottom-info-status">
        <div class="container-fluid align-items-center justify-content-end">
            <div class="d-flex user-infos flex-grow-1 justify-content-start align-items-center">
                <div class="user-image btn-circle-64 badge badge--bottom badge--right p-0 mr-4">
                    <img src="{{ mission.user.getAvatar() }}" class="img-fluid rounded-circle" alt="User-Avatar">
                    <img src="/images/icons/cm-level-badge-01.svg" class="badge-icon" alt="User-Badge">
                </div>
                <div class="user-name-level mr-4">
                    <p class="mb-0 fz-12 text-inprogress experte-level">Experte Pix.City</p>
                    <p class="mb-0 text-darkgray user-name">@{{ mission.user.firstname }}</p>
                </div>
                {% if mission.region | length > 0 %}
                <div class="mr-4">
                    <p class="mb-0 fz-12 text-normalgray">Région</p>
                    <p class="mb-0 text-darkgray user-region">{{ mission.region.name }}</p>
                </div>
                {% endif %}
                <div class="mr-4">
                    <p class="mb-0 fz-12 text-normalgray">Prix</p>
                    <p class="mb-0 text-darkgray user-price">{{ mission.userMissionPayment.clientTotal |round(2, 'floor') }} €</p>
                </div>
                {% if mission.status == 'terminated' %}
                    <div class="mission-invoice d-flex align-items-center">
                        <p class="mb-0 fz-12 text-darkgray"><i class="fas fa-file-invoice-dollar fz-20 mr-2"></i></p>
                        <p class="mb-0 text-darkgray">
                            {{ mission.briefFiles }}
                            <a href="/invoices/{{ mission.id }}/{{ filename }}-client.pdf" class="d-block fz-12 text-inprogress" download>Voir le devis</a>
                        </p>
                    </div>
                {% endif %}
            </div>
            <div class="preview-cta d-flex align-items-center">
                {% if mission.status == 'terminate_request_cm' or mission.status == 'cancel_request_cm'  %}
                <div class="dropdown dropup mt-3 mr-2">
                    <i class="far fa-ellipsis-v fz-18 px-3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="userActions"></i>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userActions">
                        {% if mission.status == 'terminate_request_cm' %}
                            <a class="dropdown-item text-darkgray fz-12" href="javascript:;" id="terminateMission" data-id="{{ mission.id }}" data-adjust-amount="{{ mission.userMissionPayment.adjustment }}" data-toggle="modal" data-target="#endMissionConfirmation"><i class="far fa-check-circle mr-2"></i>Accept Terminer</a>
                        {% endif %}
                        {% if mission.status == 'cancel_request_cm' %}
                            <a class="dropdown-item text-pink fz-12" href="javascript:;" id="mission-cancel" data-id="{{ mission.id }}"><i class="far fa-times-circle mr-2"></i>Accept Annuler</a>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                <a class="close-mission-preview text-darkgray d-flex flex-column align-items-center fz-12 text-decoration-none"
                   href="javascript:;">
                    <img src="/images/icons/preview-off-icon.svg" alt="Preview off">Retourner aux missions
                </a>

            </div>
        </div>
    </nav>

{% else %}


    <!------ Invoice preview ---------->


    <div id="invoice">

        <div class="toolbar hidden-print">
            <div class="text-right">
                <button id="printInvoice" class="btn btn-info"><i class="fa fa-print"></i> Print</button>
                <a class="close-mission-preview text-darkgray d-flex flex-column align-items-center fz-12 text-decoration-none"
                   href="javascript:;">
                    <img src="/images/icons/preview-off-icon.svg" alt="Preview off">Retourner aux missions
                </a>
            </div>
            <hr>
        </div>
        <div class="invoice overflow-auto">
            <div style="min-width: 600px">
                <header>
                    <div class="row">

                        <div class="col company-details">
                            <h2 class="name">
                                <a target="_blank" href="https://lobianijs.com">
                                    {{ app.user.firstname }}
                                </a>
                            </h2>
                            <div>{{ app.user.ClientInfo.address }}</div>
                            <div>{{ app.user.ClientInfo.postalCode }}</div>
                            <div>{{ app.user.ClientInfo.email }}</div>
                        </div>
                    </div>
                </header>
                <main>
                    <div class="row contacts">
                        <div class="col invoice-to">
                            <div class="text-gray-light">CITY MAKER:</div>
                            <h2 class="to">{{ mission.user.firstname }}</h2>
                            <div class="address">{{ mission.user.pixie.billing.address.address }}</div>
                            <div class="address">{{ mission.user.pixie.billing.address.zipcode }}</div>
                            <div class="email"><a href="mailto:john@example.com">{{ mission.user.pixie.billing.address.city }} - {{ mission.user.pixie.billing.address.country }}</a></div>
                        </div>
                        <div class="col invoice-details">
                            <h1 class="invoice-id">Numéro de facture PIX CITY SERVICES PX-{{ mission.id }}-{{ mission.createdAt | date('dmy') }}</h1>
                            <div class="date">Date de facture: {{ mission.updatedAt | date('d/m/Y') }}</div>
                        </div>
                    </div>
                    <table border="0" cellspacing="0" cellpadding="0">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th class="text-left">DESCRIPTION</th>
                            <th class="text-right">QUANTITE</th>
                            <th class="text-right">MONTANT</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="no">01</td>
                            <td class="text-left">
                                {{ mission.description }}
                            </td>
                            <td class="qty">1</td>
                            <td class="total">{{ mission.userMissionPayment.clientPrice }}</td>
                        </tr>

                        </tbody>
                        <tfoot>
                        <tr>
                            <td colspan="1"></td>
                            <td colspan="1">SUBTOTAL</td>
                            <td>{{ mission.userMissionPayment.clientPrice }}</td>
                        </tr>
                        <tr>
                            <td colspan="1"></td>
                            {% if mission.userMissionPayment.clientTotal - mission.userMissionPayment.clientPrice == 0 %}
                                <td colspan="1">TAX 0%</td>
                                <td>0</td>
                            {% else %}
                                <td colspan="1">TAX 20%</td>
                                <td>{{ mission.userMissionPayment.clientTax }}</td>
                            {% endif %}
                        </tr>
                        <tr>
                            <td colspan="1"></td>
                            <td colspan="1">GRAND TOTAL</td>
                            <td>{{ mission.userMissionPayment.clientTotal |round(2, 'floor') }} €</td>
                        </tr>
                        </tfoot>
                    </table>
                    <div class="thanks">Thank you!</div>
                    <div class="notices">
                        <div>NOTICE:</div>
                        <div class="notice">Conditions d'escompte Néant / La prestation est réalisée et payée selon les conditions générales d'utilisation du City Maker, ainsi que selon les stipulations pour autrui nées de l'acceptation par les parties des conditions générales Pix.city Services que les parties reconnaissent avoir lues et acceptées et qui sont disponibles à l'adresse [URL]XXXX.</div>
                        <div class="notice">En cas de retard de paiement s'applique une pénalité égale au taux d'intérêt appliqué par la Banque Centrale Européenne (BCE) à son opération de refinancement la plus récente majorée de 10 points.</div>
                        <div class="notice">Indemnité forfaitaire pour frais de recouvrement de 40 euros .</div>
                    </div>
                </main>
                <footer>
                    Invoice was created on a computer and is valid without the signature and seal.
                </footer>
            </div>
            <!--DO NOT DELETE THIS div. IT is responsible for showing footer always at the bottom-->
            <div></div>
        </div>
    </div>

{% endif %}


